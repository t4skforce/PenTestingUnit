from flask import Blueprint, render_template, redirect, request, g, url_for, jsonify, send_from_directory
from flask_login import login_required
from ... import app, db
import os

data = Blueprint('data', __name__, template_folder='templates', static_url_path='/static', static_folder='../../views/static', url_prefix='/data')

@data.route('/list.html',methods=['GET'])
@login_required
def list():
    return render_template('list.html',kismet=sorted(os.listdir('/var/log/kismet'), reverse=True))


@data.route('/download/kismet/<path:filename>',methods=['GET'])
@login_required
def download(filename):
    return send_from_directory('/var/log/kismet',filename, as_attachment=True)
