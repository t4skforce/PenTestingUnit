from flask import Blueprint, render_template, redirect, request, g, url_for, jsonify, send_from_directory
from flask_login import login_required
from ... import app, db
import os

data = Blueprint('data', __name__, template_folder='templates', static_url_path='/static', static_folder='../../views/static', url_prefix='/data')
KISMET_FOLDER='/var/log/kismet'
SDR_FOLDER='/var/log/rtl_sdr'

@data.route('/list.html',methods=['GET'])
@login_required
def list():
    return render_template('list.html',kismet=sorted(os.listdir(KISMET_FOLDER), reverse=True),rtl_sdr=sorted(os.listdir(SDR_FOLDER), reverse=True))


@data.route('/download/kismet/<path:filename>',methods=['GET'])
@login_required
def download_kismet(filename):
    return send_from_directory(KISMET_FOLDER,filename, as_attachment=True)

@data.route('/download/sdr/<path:filename>',methods=['GET'])
@login_required
def download_sdr(filename):
    return send_from_directory(SDR_FOLDER,filename, as_attachment=True)
